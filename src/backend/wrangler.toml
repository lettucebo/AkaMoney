name = "akamoney-api"
main = "src/index.ts"
compatibility_date = "2024-12-17"
node_compat = true

# Workers configuration
workers_dev = true

# D1 Database binding
# IMPORTANT: For CD deployment, database_id is injected from GitHub Secrets (CLOUDFLARE_D1_DATABASE_ID).
# For local development, copy wrangler.local.toml.example to wrangler.local.toml and set your database_id.
# Run local dev with: wrangler dev --config wrangler.local.toml
[[d1_databases]]
binding = "DB"
database_name = "akamoney-clicks"
database_id = ""

# R2 Storage binding (used when STORAGE_PROVIDER = "r2")
[[r2_buckets]]
binding = "BUCKET"
bucket_name = "akamoney-storage"
preview_bucket_name = "akamoney-storage-preview"

# Azure Storage Configuration (used when STORAGE_PROVIDER = "azure")
# Set these secrets via wrangler secret put:
#   wrangler secret put AZURE_STORAGE_ACCOUNT_NAME
#   wrangler secret put AZURE_STORAGE_ACCOUNT_KEY
#   wrangler secret put AZURE_STORAGE_CONTAINER_NAME
# Optional: wrangler secret put AZURE_STORAGE_ENDPOINT_URL

# Environment variables (secrets should be set via wrangler secret put)
[vars]
ENVIRONMENT = "development"
JWT_EXPIRES_IN = "7d"
# Storage provider: 'r2' (default) or 'azure'
STORAGE_PROVIDER = "r2"

# Routes for production
# [[routes]]
# pattern = "aka.money/*"
# zone_name = "aka.money"
